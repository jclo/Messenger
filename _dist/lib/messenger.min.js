/*! ****************************************************************************
 * Messenger v0.0.0
 *
 * A tiny Javascript library to handle messages that carry a payload.
 * (you can download it from npm or github repositories)
 * Copyright (c) 2019 Mobilabs <contact@mobilabs.fr> (http://www.mobilabs.fr).
 * Released under the MIT license. You may obtain a copy of the License
 * at: http://www.opensource.org/licenses/mit-license.php).
 * ************************************************************************** */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define([""],t):"object"==typeof exports?(module.exports=t(e),null===e.Messenger&&(e.Messenger=t(e))):e.Messenger=t(e)}(this,e=>{"use strict";let t,n;const r={Public:{}};return n=function(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r++)e[n[r]]=t[n[r]]},function(){const e=r.Public;function t(e,t){Object.prototype.hasOwnProperty.call(e,t)||(e[t]={listeners:[],listenersOnce:[]})}function s(e,t){Object.prototype.hasOwnProperty.call(e,t)||(e[t]={stream:{firing:!1,listeners:[]}})}n(e,{addEvents(e,n){if("string"==typeof n)t(e,n);else if(Array.isArray(n))for(let r=0;r<n.length;r++)"string"==typeof n[r]&&t(e,n[r])},addStreamEvents(e,t){if("string"==typeof t)s(e,t);else if(Array.isArray(t))for(let n=0;n<t.length;n++)"string"==typeof t[n]&&s(e,t[n])},fire(e,t,n){if("string"==typeof t&&Object.prototype.hasOwnProperty.call(e,t)){for(let r=0;r<e[t].listeners.length;r++)e[t].listeners[r](n);for(let r=0;r<e[t].listenersOnce.length;r++)e[t].listenersOnce[r](n);e[t].listenersOnce.splice(0,e[t].listenersOnce.length)}},addEventListener(e,t,n,r){r&&this.addEvents(e,t),"string"==typeof t&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(e,t)&&e[t].listeners.push(n)},addOneTimeEventListener(e,t,n,r){r&&this.addEvents(e,t),"string"==typeof t&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(e,t)&&e[t].listenersOnce.push(n)},removeEventListener(e,t,n){let r;"string"==typeof t&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(e,t)&&((r=e[t].listeners.indexOf(n))>=0&&e[t].listeners.splice(r,1),(r=e[t].listenersOnce.indexOf(n))>=0&&e[t].listenersOnce.splice(r,1))},fireQ(e,t,n){const{stream:r}=e[t],s=r.listeners;r.firing=!0,function e(){s.length>0?s.shift().apply(n||{},[e].concat(Array.prototype.slice.call(arguments,0))):r.firing=!1}()},fireQL(e,t,n){const{stream:r}=e[t],s=r.listeners;r.firing=!0,function e(){if(s.length>0){for(;s.length>1;)s.shift();s.shift().apply(n||{},[e].concat(Array.prototype.slice.call(arguments,0)))}else r.firing=!1}()},addEventStreamListener(e,t,n){"string"==typeof t&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(e,t)&&(e[t].stream.listeners.push(n),e[t].stream.firing||this.fireQ(e,t))},addEventStreamListenerLast(e,t,n){"string"==typeof t&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(e,t)&&(e[t].stream.listeners.push(n),e[t].stream.firing||this.fireQL(e,t))}})}(),function(){const n=r.Public,s=e.Messenger;let i;(t=function(e){const t=Object.create(i);return t.db={},t.addEvents(e),t}).VERSION="0.0.0",t.noConflict=function(){return e.Messenger=s,this},i={addEvents(e){return n.addEvents(this.db,e),this},addStreamEvents(e){return n.addStreamEvents(this.db,e),this},fire(e,t){return n.fire(this.db,e,t),this},trigger(e,t){return this.fire(e,t)},addEventListener(e,t){return n.addEventListener(this.db,e,t,this.open),this},addOneTimeEventListener(e,t){return n.addOneTimeEventListener(this.db,e,t,this.open),this},removeEventListener(e,t){return n.removeEventListener(this.db,e,t),this},on(e,t){return this.addEventListener(e,t)},one(e,t){return this.addOneTimeEventListener(e,t)},off(e,t){return this.removeEventListener(e,t)},fireQActive(e){return this.db[e].stream.firing},fireQ(e,t){return n.fireQ(this.db,e,t),this},fireQL(e,t){return n.fireQL(this.db,e,t),this},addEventStreamListener(e,t){return n.addEventStreamListener(this.db,e,t),this},addEventStreamListenerLast(e,t){return n.addEventStreamListenerLast(this.db,e,t),this},q(e,t){return this.addEventStreamListener(e,t)},ql(e,t){return this.addEventStreamListenerLast(e,t)},setOpen(){return this.open=!0,this}}}(),t});